var $menu=function(){var t=$("#note"),e=$('<div id="menu" class="menu"></div>'),l=[{title:"文件",items:[{title:"新建"},{title:"打开"},{title:"保存"},{title:"|ू･ω･` )"}]},{title:"编辑",items:[{title:"剪切"},{title:"复制"},{title:"粘贴"},{title:"删除"}]},{title:"格式",items:[{title:"字体"}]},{title:"查看",items:[{title:"看了个寂寞"}]},{title:"帮助",items:[{title:"关于"}]}],a=-1;function s(){var t=$(".menu-items");t.css("display","none"),-1!=a&&t.eq(a).css("display","inline-block")}return{init:function(){!function(){for(var t=$('<ul class="menu-title"></ul>'),i=0;i<l.length;i++){var n=$('<li class="menu-title-items"></li>');n.html(l[i].title),n.attr("menu-title",i),t.append(n),e.append(t),n.click(function(t){a=$(this).attr("menu-title"),s(),t.stopPropagation()}),n.hover(function(){-1!==a&&(a=$(this).attr("menu-title"),s())})}}(),function(){for(var t=0;t<l.length;t++){for(var i="",n=0;n<l[t].items.length;n++)i+='<li class="menu-items-items" menu-items='+t+"-"+n+">"+l[t].items[n].title+"</li>";var s=$('<ul class="menu-items">'+i+"</ul>");s.css("left",54*t),e.append(s)}a=-1,$font.init(),e.find("[menu-items='2-0']").click(function(){$font.show()})}(),t.append(e)},hideItems:function(){a=-1,s()}}}(),$text=function(){var t=$("#note"),i=$('<div id="text" class="text"></div>'),n=$('<textarea spellcheck="false"></textarea>');return $(window).resize(function(){i.css("height",window.innerHeight-27)}),{init:function(){i.css("height",window.innerHeight-27),i.append(n),t.append(i)},show:function(){n.css("font-family",cfg.family),n.css("font-size",cfg.size+"px"),"斜体"==cfg.style?(n.css("font-style","italic"),n.css("font-weight","normal")):"粗体"==cfg.style?(n.css("font-style","normal"),n.css("font-weight","bold")):"粗偏斜体"==cfg.style?(n.css("font-style","italic"),n.css("font-weight","bold")):(n.css("font-style","normal"),n.css("font-weight","normal"))}}}(),$font=function(){var t=$('<div  id="font" class="font"><div class="fontbox"><div class="fonttitle"><p class="fonttitle-text">字体</p><span class="fonttitle-closebtn" title="关闭">✖</span></div><div class="fontmain"><div class="fontmain-family"><p>字体(F):</p></div><div class="fontmain-style"><p>字形(Y):</p></div><div class="fontmain-size"><p>大小(S):</p></div><fieldset class="fontmain-sample"><legend>示例</legend><p class="fontmain-sample-txt">AaBbYyZz</p></fieldset><div class="fontmain-script"><label><span>脚本(R):</span><select><option value="西欧语言">西欧语言</option><option value="中文 GB2312">中文 GB2312</option></select></label></div></div><div class="fontfoot"><input class="fontfoot-ok" type="button" value="确定"><input class="fontfoot-cancel" type="button" value="取消"></div></div></div>'),i=t.find(".fonttitle-closebtn"),n=t.find(".fontfoot-cancel"),s=t.find(".fontfoot-ok"),e=t.find(".fontmain-family"),l=t.find(".fontmain-style"),a=t.find(".fontmain-size"),o=t.find(".fontmain-sample-txt"),f=["Agency FB","Algerian","Arial","Arial Rounded MT","Axure Handwriting","Bahnschrift","Baskerville Old Face","Bauhaus 93","Bell MT","Berlin Sans FB","Bernard MT","BlackAdder ITC"],c=["常规","斜体","粗体","粗偏斜体"],m=["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72"],d={};function u(t,i){var n=$('<ul class="fontmain-list"></ul>'),s=$('<input class="fontmain-list-title" type="text">'),e=$('<div class="fontmain-box"></div>'),l=i.attr("class");("fontmain-family"==l?function(t,i){for(var n=0;n<t.length;n++){var s=$('<li class="fontmain-list-item"></li');s.css("font-family",t[n]),t[n]==cfg.family&&s.addClass("use"),s.html(t[n]),i.append(s),s.click(function(){$("div.fontmain-family .fontmain-list-item").removeClass("use"),$(this).addClass("use"),cfg.family=$(this).html(),p(),r()})}}:"fontmain-style"==l?function(t,i){for(var n=0;n<t.length;n++){var s=$('<li class="fontmain-list-item"></li');s.html(t[n]),"斜体"==t[n]?s.css("font-style","italic"):"粗体"==t[n]?s.css("font-weight","bold"):"粗偏斜体"==t[n]&&(s.css("font-style","italic"),s.css("font-weight","bold")),t[n]==cfg.style&&s.addClass("use"),i.append(s),s.click(function(){$("div.fontmain-style .fontmain-list-item").removeClass("use"),$(this).addClass("use"),cfg.style=$(this).html(),p(),r()})}}:function(t,i){for(var n=0;n<t.length;n++){var s=$('<li class="fontmain-list-item"></li');t[n]==cfg.size&&s.addClass("use"),s.html(t[n]),i.append(s),s.click(function(){$("div.fontmain-size .fontmain-list-item").removeClass("use"),$(this).addClass("use"),cfg.size=$(this).html(),p(),r()})}})(t,n),e.append(s),e.append(n),i.append(e)}function p(){$("div.fontmain-family input").val(d.family),$("div.fontmain-style input").val(d.style),$("div.fontmain-size input").val(d.size)}function r(){o.css("font-family",d.family),o.css("font-size",d.size+"px"),"斜体"==d.style?(o.css("font-style","italic"),o.css("font-weight","normal")):"粗体"==d.style?(o.css("font-style","normal"),o.css("font-weight","bold")):"粗偏斜体"==d.style?(o.css("font-style","italic"),o.css("font-weight","bold")):(o.css("font-style","normal"),o.css("font-weight","normal"))}function v(){t.css("display","none")}return i.click(function(){v()}),n.click(function(){v()}),s.click(function(){$.extend(cfg,d),$text.show(),v()}),t.click(function(t){t.stopPropagation()}),{init:function(){d=cfg,$("#note").append(t),u(f,e),u(c,l),u(m,a),p(),r()},show:function(){t.css("display","block")}}}(),cfg={family:"Arial",style:"常规",size:"16"};$(function(){$menu.init(),$text.init(),$("body").click(function(){$menu.hideItems()})});